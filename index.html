<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Modern Learning Lab | 100 Mins Challenge</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&family=Montserrat:wght@600;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary-blue: #007bff;
      --light-blue: #e7f1ff;
      --success-green: #2ecc71;
      --text-main: #2d3436;
      --bg-body: #f4f7f6;
      --white: #ffffff;
      --shadow: 0 10px 30px rgba(0, 123, 255, 0.1);
    }

    body {
      background-color: var(--bg-body);
      font-family: 'Inter', sans-serif;
      margin: 0; display: flex; justify-content: center; align-items: center;
      height: 100vh; overflow: hidden;
    }

    .card {
      background: var(--white); padding: 40px; border-radius: 24px;
      width: 90%; max-width: 500px; box-shadow: var(--shadow); text-align: center;
    }

    h1 { font-family: 'Montserrat', sans-serif; color: var(--primary-blue); font-weight: 800; }

    .btn {
      display: block; width: 100%; margin: 12px 0; padding: 16px;
      font-weight: 600; color: var(--primary-blue); background: var(--white);
      border: 2px solid var(--primary-blue); border-radius: 12px; cursor: pointer; transition: 0.2s;
    }

    .btn:hover { background: var(--primary-blue); color: var(--white); transform: translateY(-2px); }

    .sub-menu { display: none; }

    /* OVERLAY */
    .overlay {
      display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(45, 52, 54, 0.6); backdrop-filter: blur(8px);
      z-index: 1000; justify-content: center; align-items: center;
    }

    .window {
      width: 95%; max-width: 700px; background: var(--white); border-radius: 20px;
      overflow: hidden; box-shadow: 0 20px 50px rgba(0,0,0,0.2);
    }

    .header { padding: 20px; background: var(--primary-blue); color: white; display: flex; justify-content: space-between; font-weight: 700; }

    .quiz-body { padding: 40px; text-align: center; }
    .q-text { font-size: 1.4rem; font-weight: 600; margin-bottom: 25px; min-height: 60px; }
    
    /* ƒê√°p √°n tr·∫Øc nghi·ªám */
    .ans-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }

    /* Tr·∫£ l·ªùi nhanh (Input) */
    .quick-input-area { display: none; margin-top: 20px; }
    .quick-input {
      width: 60%; padding: 15px; border: 2px solid var(--primary-blue);
      border-radius: 10px; font-size: 1.2rem; text-align: center; outline: none;
    }

    #musicBtn { position: fixed; top: 20px; right: 25px; border: none; background: white; width: 50px; height: 50px; border-radius: 50%; cursor: pointer; box-shadow: var(--shadow); font-size: 1.2rem; }
  </style>
</head>
<body>

  <audio id="bgMusic" loop><source src="Landing.mp3" type="audio/mpeg"></audio>
  <button id="musicBtn">üéß</button>

  <div class="card">
    <h1>Learning Lab</h1>
    <p style="color: #636e72;">Th·ª≠ th√°ch 100 ph√∫t: Tr·∫Øc nghi·ªám & Ph·∫£n x·∫°</p>
    
    <div id="mainBtns">
      <button class="btn" onclick="openChat()">AI Assistant</button>
      <button class="btn" onclick="showMenu('studyMenu')">Learning Hub</button>
    </div>

    <div id="studyMenu" class="sub-menu">
      <button class="btn" style="background: var(--light-blue);" onclick="startChallenge()">B·∫ÆT ƒê·∫¶U CHALLENGE (100P)</button>
      <button class="btn" onclick="back()">Quay l·∫°i</button>
    </div>
  </div>

  <div id="quizOverlay" class="overlay">
    <div class="window">
      <div class="header">
        <span id="modeName">TR·∫ÆC NGHI·ªÜM</span>
        <span id="timer">100:00</span>
      </div>
      <div class="quiz-body">
        <div id="qText" class="q-text">ƒêang t·∫£i...</div>
        
        <div id="ansGrid" class="ans-grid"></div>

        <div id="quickArea" class="quick-input-area">
          <input type="number" id="quickInput" class="quick-input" placeholder="Nh·∫≠p k·∫øt qu·∫£...">
          <button class="btn" style="width: auto; display: inline-block; margin-left: 10px;" onclick="checkQuick()">G·ª¨I</button>
        </div>

        <div style="margin-top: 30px; font-size: 0.9rem;">
          C√¢u: <b><span id="qCount">1</span></b> | ƒê√∫ng: <b style="color: var(--success-green);"><span id="score">0</span></b>
        </div>
      </div>
    </div>
  </div>

  <div id="chatOverlay" class="overlay">
    <div class="window" style="height: 80vh;">
      <div class="header"><span>AI Chatbot</span> <button onclick="closeAll()" style="color:white; background:none; border:none; cursor:pointer;">ƒê√≥ng</button></div>
      <iframe src="https://study-bot-web-e2um.onrender.com/" style="width:100%; height:100%; border:none;"></iframe>
    </div>
  </div>

  <script>
    let currentQ = 1, score = 0, timer, timeLeft = 6000, correctAns = 0;

    function showMenu(id) { document.getElementById('mainBtns').style.display='none'; document.getElementById(id).style.display='block'; }
    function back() { document.querySelectorAll('.sub-menu').forEach(m=>m.style.display='none'); document.getElementById('mainBtns').style.display='block'; }
    function openChat() { document.getElementById('chatOverlay').style.display='flex'; }
    function closeAll() { document.querySelectorAll('.overlay').forEach(o=>o.style.display='none'); clearInterval(timer); }

    function startChallenge() {
      document.getElementById('quizOverlay').style.display = 'flex';
      currentQ = 1; score = 0; timeLeft = 6000;
      loadQuestion();
      runTimer();
    }

    function loadQuestion() {
      document.getElementById('qCount').innerText = currentQ;
      document.getElementById('score').innerText = score;
      const isQuick = Math.random() > 0.5; // Ng·∫´u nhi√™n ch·ªçn ch·∫ø ƒë·ªô
      
      const a = Math.floor(Math.random() * 100) + 20;
      correctAns = 180 - a;

      if(isQuick) {
        // CH·∫æ ƒê·ªò TR·∫¢ L·ªúI NHANH
        document.getElementById('modeName').innerText = "TR·∫¢ L·ªúI NHANH";
        document.getElementById('ansGrid').style.display = 'none';
        document.getElementById('quickArea').style.display = 'block';
        document.getElementById('qText').innerText = `G√≥c k·ªÅ b√π v·ªõi g√≥c ${a}¬∞ l√† bao nhi√™u ƒë·ªô?`;
        document.getElementById('quickInput').value = '';
        document.getElementById('quickInput').focus();
      } else {
        // CH·∫æ ƒê·ªò TR·∫ÆC NGHI·ªÜM
        document.getElementById('modeName').innerText = "TR·∫ÆC NGHI·ªÜM";
        document.getElementById('ansGrid').style.display = 'grid';
        document.getElementById('quickArea').style.display = 'none';
        document.getElementById('qText').innerText = `Cho hai g√≥c k·ªÅ b√π, m·ªôt g√≥c b·∫±ng ${a}¬∞. G√≥c c√≤n l·∫°i l√†:`;
        
        const grid = document.getElementById('ansGrid');
        grid.innerHTML = '';
        [correctAns, correctAns+10, correctAns-10, 90].sort(()=>Math.random()-0.5).forEach(val => {
          const b = document.createElement('button');
          b.className = 'btn'; b.innerText = val + "¬∞";
          b.onclick = () => { if(val === correctAns) score++; currentQ++; loadQuestion(); };
          grid.appendChild(b);
        });
      }
    }

    function checkQuick() {
      const val = parseInt(document.getElementById('quickInput').value);
      if(val === correctAns) score++;
      currentQ++;
      loadQuestion();
    }

    // Cho ph√©p nh·∫•n Enter ƒë·ªÉ g·ª≠i c√¢u tr·∫£ l·ªùi nhanh
    document.getElementById('quickInput').addEventListener('keypress', (e) => {
      if(e.key === 'Enter') checkQuick();
    });

    function runTimer() {
      clearInterval(timer);
      timer = setInterval(() => {
        let m = Math.floor(timeLeft/60), s = timeLeft%60;
        document.getElementById('timer').innerText = `${m}:${s<10?'0'+s:s}`;
        if(timeLeft-- <= 0) { clearInterval(timer); alert("H·∫øt gi·ªù! K·∫øt qu·∫£: " + score + " c√¢u ƒë√∫ng."); closeAll(); }
      }, 1000);
    }

    // √Çm nh·∫°c
    let playing = false;
    document.getElementById('musicBtn').onclick = () => {
      const m = document.getElementById('bgMusic');
      if(!playing) m.play(); else m.pause();
      playing = !playing;
      document.getElementById('musicBtn').innerText = playing ? 'üîä' : 'üéß';
    };
  </script>
</body>
</html>
